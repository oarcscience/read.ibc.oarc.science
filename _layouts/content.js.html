{% assign pagedata = site.data.meta | where: "id", page.id | first %}
{% assign bible = site.data.globalbase | where: "filename", pagedata.source %}
{% assign locnumnames = "1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150" %}
{% if  pagedata.locnumnames %}{% assign locnumnames = pagedata.locnumnames %}{% endif %}
function readchapter(e,n,r){for(var t=null,o=null,a=null,i=-1,c="";" "==e.charAt(e.length-1);)e=e.substring(0,e.length-1);e.length>0&&(c=e.split(" ")),(0>n-0||n-0>=66)&&(n=0),0>=n-0&&0>r-0&&(r=0),n-0>=65&&r-0>=22&&(r=21),0>r-0&&(n--,r=book_chapters[n+1]-book_chapters[n]-1),r-0>=book_chapters[n+1]-book_chapters[n]&&(n++,r=0);var s,h=chapter_lines[book_chapters[n]+r],l=chapter_lines[book_chapters[n]+r+1],p=1;t=document.getElementById("nothing"),"{{pagedata.locpsalmbookname}}"!=books[n]?(t.innerHTML='<h2 class="chapter-title">'+books[n]+"{{pagedata.locspacingpref }}{{pagedata.locchapterpref }}"+numbers[r]+"{{pagedata.locchaptersuff  }}</h2>",t.style.paddingTop="5rem",document.title="{{pagedata.locsitetitle }} — "+books[n]+"{{pagedata.locchapterpref }}"+numbers[r]+"{{pagedata.locchaptersuff  }}"):(t.innerHTML='<h2 class="chapter-title">'+books[n]+"{{pagedata.locpsalmpref }}{{pagedata.locspacingpref }}"+numbers[r]+"{{pagedata.locpsalmcountword }}</h2>",t.style.paddingTop="5rem",document.title="{{pagedata.locsitetitle }} — "+books[n]+"{{pagedata.locchapterpref  }}"+numbers[r]+"{{pagedata.locpsalmcountword }}"),o=document.createElement("DIV"),o.className+="verse-container",o.style.paddingBottom="5rem",t.appendChild(o);for(var u=h;l>u;u++){var f=profiles[u].substring(profiles[u].indexOf(" "));for(a=document.createElement("OL"),o.appendChild(a),s=document.createElement("LI"),i=0;i<c.length&&e.length>0;){for(var d="",g=c[i];-1!=f.indexOf(g);)d+=f.substring(0,f.indexOf(g))+g.fontcolor("red"),f=f.substring(f.indexOf(g)+g.length);d+=f,f=d,i++}s.innerHTML=f,a.appendChild(s),s.setAttribute("value",p++)}temp1='<a href="" class="btn" onClick="readchapter(\''+e+"', nowbook,--nowchapter); return false;\">←</a>\n",temp2='<a href="" class="btn" onClick="readchapter(\''+e+"', nowbook,++nowchapter); return false;\">→</a>\n",nowbook=n,nowchapter=r;navigator.userAgent.toLowerCase();s=document.getElementById("link2"),s.innerHTML="",s.innerHTML+=temp1,s.innerHTML+=temp2,location.hash="#top",location=location,location.hash="#"+n+"_"+r}function replacing(e,n){for(var r=e;-1!=r.indexOf(n);)r=r.replace(n," § ");for(;-1!=r.indexOf("§");)r=r.replace(/§/,n);return r}function validate(e,n,r){var t;for(t=1;9>t;t++)e=replacing(e,operators[t]);for(;-1!=e.indexOf("  ");)e=e.replace(/  /," ");for("+"==e.charAt(0)?(e=e.substring(1,e.length),searchType=SEARCHALL):"url:"==e.substring(0,4)?(e=e.substring(5,e.length),searchType=SEARCHURL):searchType=SEARCHANY;" "==e.charAt(0);)e=e.substring(1,e.length),document.search.query.value=e;for(;" "==e.charAt(e.length-1);)e=e.substring(0,e.length-1),document.search.query.value=e;convertString(e,n,r)}function convertString(e,n,r){var t=e.split(" ");allowAny(t,n,r)}function evaluate(e){var n=new Array(0),r=-1;for(i=0;i<e.length;i++)e[i]===!1||e[i]===!0?n[++r]=e[i]:"!"==e[i].charAt(0)||"-"==e[i].charAt(0)?n[r]?n[r]=!1:n[r]=!0:("*"==e[i].charAt(0)||"&"==e[i].charAt(0))&&r>=1?(n[r-1]&&n[r]?n[r-1]=!0:n[r-1]=!1,r--):("+"==e[i].charAt(0)||"|"==e[i].charAt(0))&&r>=1&&(n[r-1]||n[r]?n[r-1]=!0:n[r-1]=!1,r--);for(i=r;i>0;i--)n[i-1]&&n[i]?n[i-1]=!0:n[i-1]=!1;return n[0]}function postfix(e){var n,r=[],t=-1,o=0,a=0,i=[];for(r[++t]=0;o<e.length;){for(n=0;9>n&&e[o]!=operators[n];n++);if(9==n)i[a++]=e[o];else if(8==n){for(;t>0&&7!=r[t];)i[a++]=operators[r[t--]];7==r[t]&&t--}else{for(;isp[r[t]]<=icp[n];)i[a++]=operators[r[t--]];r[++t]=n}o++}for(;t>0;)i[a++]=operators[r[t--]];return i}function allowAny(e,n,r){var t,o,a,i=new Array(0),c=new Array(0),s=new Array(0),h=new Array(0),l=1,p=new Array(0);for(e=postfix(e),opnum=0,o=0;o<e.length;o++)"*"==e[o].charAt(0)||"+"==e[o].charAt(0)||"!"==e[o].charAt(0)||"&"==e[o].charAt(0)||"|"==e[o].charAt(0)||"-"==e[o].charAt(0)?h[o]=e[o]:(h[o]=!0,s[opnum]=o,c[opnum++]=e[o]);for(t=0;t<opnum;t++)l*=2;for(t=0;l>t;t++){for(a=t,o=0;o<opnum;o++)a%2===0?h[s[o]]=!1:h[s[o]]=!0,a>>=1;evaluate(h)?p[t]=!0:p[t]=!1}for(nowbook=0,nowchapter=0,t=chapter_lines[book_chapters[n]];t<chapter_lines[book_chapters[r+1]];t++){var u,f=profiles[t],d=profiles[t].toUpperCase();u=searchType==SEARCHANY?d.substring(0,d.indexOf("|HTTP")):d.substring(d.indexOf("|HTTP"),d.length);var g=0;for(d=d.substring(d.indexOf(" ")+1,d.length),o=opnum-1;o>=0;o--)g+=-1==d.indexOf(c[o])?0:1,g*=2;if(g/=2,p[g]){for(o=0;o<c.length;o++){var b=c[o],A="";if(-1!=d.indexOf(b)){for(;chapter_lines[book_chapters[nowbook]+nowchapter+1]<=t;)nowchapter++,nowchapter+book_chapters[nowbook]>book_chapters[nowbook+1]&&(nowchapter=0,nowbook++);for(findbook[i.length]=nowbook,findchapter[i.length]=nowchapter,A=f.substring(0,f.indexOf(" ")+1),f=f.substring(f.indexOf(" ")+1);-1!=f.indexOf(b);)A+=f.substring(0,f.indexOf(b))+b.fontcolor("red"),f=f.substring(f.indexOf(b)+b.length);A+=f,f=A}}i[i.length]=f}}verifyManage(c,i)}function verifyManage(e,n){0===n.length?noMatch():(copyArray=n,formatResults(e,copyArray,currentMatch,showMatches))}function noMatch(){var e;e=document.getElementById("nothing"),e.innerHTML='<HR NOSHADE WIDTH=100%>"'+document.search.query.value+'" returned no results.<HR NOSHADE WIDTH=100%></TD></TR></TABLE>'}function formatResults(e,n,r,t){var o,a,i,c,s=n.length<r+t?n.length:r+t;document.title="{{pagedata.locsearchquery}}"+document.search.query.value,c="";for(var h=0;h<e.length;h++)c+=e[h]+" ";o=document.getElementById("nothing"),o.innerHTML="Search Query: <i>"+document.search.query.value+"</i><br>\n",o.innerHTML+="Search Results: <i>"+(r+1)+" — "+s+" of "+n.length+"</i><br>\n\n<!-- Begin result set //-->\n\n	",a=document.createElement("OL"),o.appendChild(a);var l=1;if(searchType==SEARCHURL)for(var p=r;s>p;p++)i=document.createElement("LI"),i.innerHTML=n[p],a.appendChild(i),i.setAttribute("value",l++);else for(var p=r;s>p;p++){var u=n[p].substring(n[p].indexOf(" "),n[p].length),f=n[p].substring(0,n[p].indexOf(" "));i=document.createElement("LI"),i.innerHTML='<a href="" onClick="readchapter(\''+c+"', "+findbook[p]+", "+findchapter[p]+'); return false;">'+f+"</a> "+u+"\n",a.appendChild(i),i.setAttribute("value",l++)}}function setachap(){var e,n,r;if(setchap(document.Reading,document.Reading.na.selectedIndex,document.Reading.chap.selectedIndex),ua=navigator.userAgent.toLowerCase(),r=location.hash,location.hash.length>1){for(e=r.substring(1,r.indexOf("_")),n=r;-1!=n.indexOf("_");)n=n.substring(n.indexOf("_")+1);readchapter(" ",e,n)}}function setchap(e,n,r){var t,o,a,i=new Array({{bible[0]["ls"] | replace: "¤", ","}});t=i[n];var c=e.chap.options.length;if(150==t&&150>c)for(o=1;150>=o;o++)a="{{pagedata.locchapterpref}}"+o+"{{pagedata.locchaptersuff}}",e.chap.options[o-1]=new Option(a,o);else if(150>t&&150==c){for(o=1;t>=o;o++)a="{{pagedata.locchapterpref}}"+o+"{{pagedata.locchaptersuff}}",e.chap.options[o-1]=new Option(a,o);for(o=150;o>t;o--)e.chap.options[o-1]=null}else if(t>c)for(o=c;t>=o;o++)a="{{pagedata.locchapterpref}}"+o+"{{pagedata.locchaptersuff}}",e.chap.options[o-1]=new Option(a,o);else if(c>t)for(o=c;o>t;o--)e.chap.options[o-1]=null;e.chap.options[0].selected=r}var SEARCHANY=1,SEARCHALL=2,SEARCHURL=4,searchType="",showMatches=2e3,currentMatch=0,copyArray=[],nowbook=39,nowchapter=0,findbook=[],findchapter=[],operators=new Array("#","*","&","|","+","!","-","(",")"),icp=new Array(3,2,2,2,2,1,1,0,3),isp=new Array(3,2,2,2,2,1,1,3,3);
function init(){function e(t,n,o){if(!(0>o)){var i=n-t.scrollTop,s=i/o*10;setTimeout(function(){t.scrollTop=t.scrollTop+s,t.scrollTop!=n&&e(t,n,o-10)},10)}}function t(){e(s.body,0,300)}function n(){window.onhashchange=function(){0!==scrollY&&t()}}function o(){function e(e){a.classList.contains(r.hasCover)&&(c=s.querySelector(".cover-txt"),s.addEventListener("mousemove",function(){console.log("mouse is moving!"),c.classList.contains(r.fadeOut)&&(c.classList.remove(r.fadeOut),c.classList.add(r.fadeIn),a.classList.remove(r.noCursor)),clearTimeout(l),l=window.setTimeout(function(){c&&(c.classList.remove(r.fadeIn),c.classList.add(r.fadeOut),a.classList.add(r.noCursor))},e)},!1))}function t(e){a.removeChild(e),a.classList.remove(r.hasCover),a.classList.remove(r.noCursor)}function n(t){a.appendChild(t),a.classList.add(r.hasCover),e(7e3)}var o=s.querySelector(".toggle-light"),i=s.createElement("div"),c=null,l=null;i.className="cover",i.innerHTML='<span class="cover-txt">Press ESC key to leave</span>',o&&(o.addEventListener("click",function(e){n(i)},!1),i.addEventListener("click",function(e){t(this)},!1),s.addEventListener("keydown",function(e){27===e.keyCode&&a.classList.contains(r.hasCover)&&t(i)},!1))}function i(){var e="";-1!=navigator.appVersion.indexOf("Win")&&(e="windows"),-1!=navigator.appVersion.indexOf("Mac")&&(e="mac"),a.classList.add(e)}var s=document,a=(document.documentElement,s.body),c=s.getElementById("nothing"),r={fadeIn:"fade-in",fadeOut:"fade-out",noCursor:"no-cursor",hasCover:"has-cover",reading:"reading-mode",lowLight:"low-light-theme",show:"show",fontSize:"font-size",mac:"mac"},l=s.querySelector(".top");l.addEventListener("click",t,!1),n(),o(),i();var d=function(e){return this===window?new d(e):(this.range=s.querySelector(e.els.range),void(this.rangeSize=s.querySelector(e.els.rangeSize)))};d.prototype={togglePanel:function(){var e=s.querySelector(".setting-btn"),t=s.querySelector(".setting-panel");e&&t&&(e.addEventListener("click",function(n){t.classList.toggle(r.show),e.classList.toggle(r.show),n.stopPropagation()},!1),t.addEventListener("click",function(e){e.stopPropagation()},!1),s.addEventListener("click",function(n){t.classList.contains(r.show)&&(t.classList.remove(r.show),e.classList.remove(r.show))},!1))},setDefaultFontSize:function(){var e=-1;window.localStorage.getItem(r.fontSize)?e=window.localStorage.getItem(r.fontSize):(e=24,window.localStorage.setItem(r.fontSize,24)),c.style.fontSize=e+"px",this.range.value=e,this.rangeSize.textContent=e+"px"},changeFontSize:function(){var e=this;this.range.addEventListener("change",function(){e.rangeSize.textContent=this.value+"px",c.style.fontSize=this.value+"px",window.localStorage.setItem(r.fontSize,this.value)},!1)},switchTheme:function(){var e=s.querySelector(".toggle-theme .toggle"),t="";window.localStorage.getItem("theme")?(t=window.localStorage.getItem("theme"),"default-theme"===t?e.checked=!1:(e.checked=!0,a.classList.add(r.lowLight))):(t="default-theme",window.localStorage.setItem("theme","default-theme"),e.checked=!1),e.addEventListener("click",function(){this.checked===!0?(a.classList.add(r.lowLight),window.localStorage.setItem("theme","low-light-theme")):(a.classList.remove(r.lowLight),window.localStorage.setItem("theme","default-theme"))},!1)},toggleVerseNumber:function(){var e=s.querySelector(".toggle-verse-number .toggle"),t=s.querySelector("#nothing"),n="";window.localStorage.getItem("verse-number")?(n=window.localStorage.getItem("verse-number"),"on"===n?(e.checked=!0,t.classList.remove("no-verse-number")):(e.checked=!1,t.classList.add("no-verse-number"))):(n="on",window.localStorage.setItem("verse-number","on"),e.checked=!0),e.addEventListener("click",function(e){this.checked===!0?(t.classList.remove("no-verse-number"),window.localStorage.setItem("verse-number","on")):(t.classList.add("no-verse-number"),window.localStorage.setItem("verse-number","off"))},!1)},initialize:function(){this.togglePanel(),this.changeFontSize(),this.setDefaultFontSize(),this.switchTheme(),this.toggleVerseNumber()}};var g=function(e){return this===window?new g(e):(this.toggle=s.querySelector(e.els.toggle),this.controls=s.querySelector(e.els.controls),void(this.content=s.querySelector(e.els.content)))};g.prototype={setReadingMode:function(){var e=this,t=function(){a.classList.add(r.reading),a.classList.contains(r.mac)||$(e.content).perfectScrollbar()},n=function(){a.classList.remove(r.reading),$(e.content).perfectScrollbar("destroy")};e.toggle&&e.toggle.addEventListener("click",function(){t()},!1),s.addEventListener("keydown",function(e){27===e.keyCode&&a.classList.contains(r.reading)&&n()},!1),s.addEventListener("keydown",function(e){e.ctrlKey&&e.altKey&&82===e.keyCode&&(a.classList.contains(r.reading)?n():t())},!1),this.controls&&this.controls.addEventListener("click",function(e){n()},!1)},initialize:function(){this.setReadingMode()}},s.addEventListener("keydown",function(e){37===e.keyCode?readchapter("",nowbook,--nowchapter):39===e.keyCode&&readchapter("",nowbook,++nowchapter)},!1);var u=new d({els:{range:".range-slide",rangeSize:".range-size"}});u.initialize();var h=new g({els:{toggle:".toggle-reading-mode",controls:".reading-mode-controls",content:".content-wrap"}});h.initialize()}window.addEventListener("load",function(){init()},!1);
books=new Array("{{ pagedata.booknames | replace: ", ", '", "' }}"),book_chapters=new Array({{bible[0]["lscum"] | replace: "¤", ","}}),numbers=new Array("{{ locnumnames | replace: ", ", '", "' }}"),chapter_lines=new Array({{bible[0]["firsts"] | replace: "¤", ","}});
profiles=new Array({{bible[0]["content"] | replace: "¤", ',' | replace: "◊", '"' }});
